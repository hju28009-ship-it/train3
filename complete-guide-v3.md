# í™”ë¬¼ì—´ì°¨ ì•ŒëŒ ì•± v3.0 - ì™„ì „ ê°€ì´ë“œ
## JavaScript ì‚¬ì´íŠ¸ í¬ë¡¤ë§ + PWA ì•„ì´ì½˜

## ğŸ“‹ ëª©ì°¨
1. [v3.0 ì—…ë°ì´íŠ¸ ë‚´ìš©](#v30-ì—…ë°ì´íŠ¸-ë‚´ìš©)
2. [ë°±ì—”ë“œ ë°°í¬ - Puppeteer](#ë°±ì—”ë“œ-ë°°í¬)
3. [í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ](#í”„ë¡ íŠ¸ì—”ë“œ-ê°œë°œ)
4. [PWA ì•„ì´ì½˜ ì„¤ì •](#pwa-ì•„ì´ì½˜-ì„¤ì •)
5. [í…ŒìŠ¤íŠ¸ ë° ë””ë²„ê¹…](#í…ŒìŠ¤íŠ¸-ë°-ë””ë²„ê¹…)

---

## ğŸ†• v3.0 ì—…ë°ì´íŠ¸ ë‚´ìš©

### ìƒˆë¡œìš´ ê¸°ëŠ¥
âœ… **Puppeteer í†µí•©**
- JavaScript ë Œë”ë§ ì‚¬ì´íŠ¸ í¬ë¡¤ë§
- ì½”ë ˆì¼ ëª¨ë°”ì¼ ì‚¬ì´íŠ¸ ì™„ë²½ ì§€ì›
- ì‹¤ì‹œê°„ ì—´ì°¨ ìœ„ì¹˜ ì •ë³´

âœ… **ë‹¤ì¤‘ ì†ŒìŠ¤ ì§€ì›**
- 1ìˆœìœ„: https://mlogis.korail.com (Puppeteer)
- 2ìˆœìœ„: https://nxlogis.kr (API)
- ìë™ í´ë°± ì‹œìŠ¤í…œ

âœ… **Docker ì§€ì›**
- Render.com ì•ˆì •ì  ë°°í¬
- Chromium ìë™ ì„¤ì¹˜
- í•œê¸€ í°íŠ¸ í¬í•¨

âœ… **PWA ì•„ì´ì½˜**
- ì—´ì°¨ + ì‹œê³„ ë””ìì¸
- 512x512, 192x192 í¬ê¸°
- Maskable icon ì§€ì›

---

## ğŸš€ ë°±ì—”ë“œ ë°°í¬

### ì¤€ë¹„ë¬¼
- GitHub ê³„ì •
- Render.com ê³„ì • (ë¬´ë£Œ)

### 1ë‹¨ê³„: GitHub ì €ì¥ì†Œ ìƒì„±

```bash
cd train-alarm-backend-v3

# Git ì´ˆê¸°í™”
git init

# ëª¨ë“  íŒŒì¼ ì¶”ê°€ (Dockerfile í¬í•¨!)
git add .

# ì»¤ë°‹
git commit -m "v3.0: Puppeteer + Dockerë¡œ JavaScript ì‚¬ì´íŠ¸ í¬ë¡¤ë§"

# GitHub ì €ì¥ì†Œ ì—°ê²°
git remote add origin https://github.com/YOUR_USERNAME/train-alarm-backend.git

# í‘¸ì‹œ
git branch -M main
git push -u origin main
```

### 2ë‹¨ê³„: Render.com Docker ë°°í¬

1. **Render.com ë¡œê·¸ì¸**
   - https://render.com
   - GitHub ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸

2. **ìƒˆ Web Service ìƒì„±**
   - "New +" â†’ "Web Service"
   - GitHub ì €ì¥ì†Œ ì—°ê²°
   - `train-alarm-backend` ì„ íƒ

3. **ì„¤ì • (ì¤‘ìš”!)**
   ```
   Name: train-alarm-backend
   Region: Singapore
   Branch: main
   Root Directory: (ë¹„ì›Œë‘ )
   
   âš ï¸ Environment: Docker (ìë™ ê°ì§€ë¨)
   
   Instance Type: Starter ($7/ì›”) ë˜ëŠ” Free (ë¶ˆì•ˆì •)
   ```

4. **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •** (ì„ íƒ ì‚¬í•­)
   ```
   NODE_ENV=production
   ```

5. **ë°°í¬ ì‹œì‘**
   - "Create Web Service" í´ë¦­
   - Docker ì´ë¯¸ì§€ ë¹Œë“œ (5-10ë¶„ ì†Œìš”)
   - ë°°í¬ ì™„ë£Œ ì‹œ URL í™•ì¸

### 3ë‹¨ê³„: ë°°í¬ í™•ì¸

#### í—¬ìŠ¤ì²´í¬
```
https://your-app.onrender.com/health
```

ì˜ˆìƒ ì‘ë‹µ:
```json
{
  "status": "ok",
  "timestamp": "2026-02-08T...",
  "dataLoaded": {
    "trains": 218,
    "stations": 87
  }
}
```

#### ì‹¤ì‹œê°„ ì—´ì°¨ ì •ë³´ í…ŒìŠ¤íŠ¸
```
https://your-app.onrender.com/api/train-info?trainDate=20260208&trainNo=3001
```

ì˜ˆìƒ ì‘ë‹µ:
```json
{
  "trainNo": "3001",
  "trainDate": "20260208",
  "status": "running",
  "currentStation": "ì²œì•ˆ",
  "stations": [
    {
      "name": "ì˜¤ë´‰",
      "arrival": "03:02",
      "departure": "03:02",
      "status": "ì¶œë°œ"
    }
  ]
}
```

### âš ï¸ ì¤‘ìš”: Free vs Starter

| í•­ëª© | Free Tier | Starter |
|------|-----------|---------|
| ë©”ëª¨ë¦¬ | 512MB | 2GB |
| Puppeteer | ë¶ˆì•ˆì • | ì•ˆì •ì  |
| Sleep | 15ë¶„ í›„ | ì—†ìŒ |
| ê°€ê²© | $0 | $7/ì›” |

**ì¶”ì²œ**: Puppeteer ì‚¬ìš© ì‹œ Starter ì´ìƒ

---

## ğŸ’» í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ

### 1ë‹¨ê³„: Lovable.dev ì¤€ë¹„

1. **lovable-prompt-v2.md** íŒŒì¼ ì—´ê¸°
2. ë°±ì—”ë“œ URL ë³€ê²½:
   ```typescript
   // ë³€ê²½ ì „
   const BACKEND_URL = 'https://your-app.onrender.com';
   
   // ë³€ê²½ í›„ (ì‹¤ì œ URL)
   const BACKEND_URL = 'https://train-alarm-backend-xyz.onrender.com';
   ```

3. **Lovable.dev**ì— í”„ë¡¬í”„íŠ¸ ì…ë ¥

### 2ë‹¨ê³„: ê¸°ëŠ¥ í™•ì¸

Lovable.devì—ì„œ ìƒì„±ëœ ì•±ì´ ë‹¤ìŒ ê¸°ëŠ¥ì„ í¬í•¨í•˜ëŠ”ì§€ í™•ì¸:

- [ ] ì—´ì°¨ë²ˆí˜¸ ìë™ì™„ì„±
- [ ] ì—­ ê²€ìƒ‰
- [ ] ì•ŒëŒ ìƒì„±/ìˆ˜ì •/ì‚­ì œ
- [ ] ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
- [ ] PWA ì§€ì›

---

## ğŸ¨ PWA ì•„ì´ì½˜ ì„¤ì •

### 1ë‹¨ê³„: ì•„ì´ì½˜ ë¦¬ì‚¬ì´ì§•

ì œê³µëœ `original-icon.png`ë¥¼ ë‘ ê°€ì§€ í¬ê¸°ë¡œ ë§Œë“¤ê¸°:

#### ì˜¨ë¼ì¸ ë„êµ¬ ì‚¬ìš©
1. **https://www.iloveimg.com/resize-image** ì ‘ì†
2. `original-icon.png` ì—…ë¡œë“œ
3. ë¦¬ì‚¬ì´ì¦ˆ:
   - 512x512 â†’ `icon-512.png` ì €ì¥
   - 192x192 â†’ `icon-192.png` ì €ì¥

### 2ë‹¨ê³„: Lovable.devì— ì•„ì´ì½˜ ì¶”ê°€

Lovable.dev ì±„íŒ…ì— ì…ë ¥:

```
public í´ë”ì— icon-512.pngì™€ icon-192.pngë¥¼ ì¶”ê°€í•˜ê³ ,
ë‹¤ìŒ ë‚´ìš©ìœ¼ë¡œ manifest.jsonì„ ì„¤ì •í•´ì¤˜:

{
  "name": "í™”ë¬¼ì—´ì°¨ ì•ŒëŒ",
  "short_name": "ì—´ì°¨ì•ŒëŒ",
  "description": "ì½”ë ˆì¼ í™”ë¬¼ì—´ì°¨ ìœ„ì¹˜ ì¶”ì  ë° ì•ŒëŒ",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#f5f5f5",
  "theme_color": "#5F6368",
  "icons": [
    {
      "src": "/icon-192.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "any maskable"
    },
    {
      "src": "/icon-512.png",
      "sizes": "512x512",
      "type": "image/png",
      "purpose": "any maskable"
    }
  ]
}

ê·¸ë¦¬ê³  ì•±ì˜ ì£¼ìš” ìƒ‰ìƒì„ #5F6368 (íšŒìƒ‰)ìœ¼ë¡œ ì„¤ì •í•´ì¤˜.
```

### 3ë‹¨ê³„: íŒŒì¼ ì—…ë¡œë“œ

#### ë°©ë²• 1: Lovable.dev UI
1. "Files" íƒ­ â†’ "public" í´ë”
2. "Upload" ë²„íŠ¼
3. `icon-512.png`, `icon-192.png` ì—…ë¡œë“œ

#### ë°©ë²• 2: ì±„íŒ… ìš”ì²­
```
icon-512.pngì™€ icon-192.png íŒŒì¼ì„ ì–´ë–»ê²Œ ì—…ë¡œë“œí•˜ë©´ ë˜ë‚˜ìš”?
```

### 4ë‹¨ê³„: í™•ì¸

1. **ê°œë°œì ë„êµ¬** (F12)
2. **Application** â†’ **Manifest**
3. ì•„ì´ì½˜ í‘œì‹œ í™•ì¸

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë° ë””ë²„ê¹…

### ë°±ì—”ë“œ í…ŒìŠ¤íŠ¸

#### 1. Docker ë¹Œë“œ ë¡œê·¸ í™•ì¸
Render.com Dashboard â†’ Logs íƒ­
```
Building Docker image...
âœ“ Chromium installed
âœ“ Korean fonts installed
âœ“ npm install completed
Server running on port 3000
```

#### 2. í¬ë¡¤ë§ í…ŒìŠ¤íŠ¸
```bash
curl "https://your-app.onrender.com/api/train-info?trainDate=20260208&trainNo=3001"
```

ì„±ê³µ ì‹œ:
```json
{
  "trainNo": "3001",
  "stations": [...],
  "status": "running"
}
```

#### 3. ë¡œê·¸ ëª¨ë‹ˆí„°ë§
```
ğŸš€ Puppeteerë¡œ ì—´ì°¨ì •ë³´ ì¡°íšŒ ì‹œì‘: 3001
âœ… í¬ë¡¤ë§ ì™„ë£Œ: 15ê°œ ì—­ ì •ë³´
```

### í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸

#### 1. ì—´ì°¨ë²ˆí˜¸ ê²€ìƒ‰
- [ ] "3001" ì…ë ¥ â†’ ë“œë¡­ë‹¤ìš´ í‘œì‹œ
- [ ] ì—´ì°¨ ì„ íƒ â†’ ì •ë³´ ìë™ ì…ë ¥

#### 2. ì—­ ê²€ìƒ‰
- [ ] "ëŒ€ì „" ì…ë ¥ â†’ ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ
- [ ] ì—­ ì„ íƒ â†’ ìë™ ì…ë ¥

#### 3. ì•ŒëŒ ìƒì„±
- [ ] ëª¨ë“  í•„ë“œ ì…ë ¥
- [ ] ì €ì¥ â†’ ëª©ë¡ì— í‘œì‹œ

#### 4. ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
- [ ] 1ë¶„ë§ˆë‹¤ ìë™ ì²´í¬
- [ ] ìƒíƒœ ì—…ë°ì´íŠ¸
- [ ] ì•ŒëŒ ë°œë™

#### 5. PWA ì„¤ì¹˜
- [ ] ëª¨ë°”ì¼ì—ì„œ "í™ˆ í™”ë©´ì— ì¶”ê°€"
- [ ] ì•„ì´ì½˜ í™•ì¸
- [ ] ì•±ì²˜ëŸ¼ ì‹¤í–‰

### ì¼ë°˜ì ì¸ ë¬¸ì œ í•´ê²°

#### ë¬¸ì œ 1: Puppeteer ë©”ëª¨ë¦¬ ë¶€ì¡±
```
Error: Protocol error (Target.createTarget): Cannot create target
```

**í•´ê²°**:
1. Render.com Starter í”Œëœ ì‚¬ìš©
2. ë˜ëŠ” v2.0 (APIë§Œ) ì‚¬ìš©

#### ë¬¸ì œ 2: í¬ë¡¤ë§ íƒ€ì„ì•„ì›ƒ
```
TimeoutError: waiting for selector 'table tr' failed
```

**í•´ê²°**:
1. íƒ€ì„ì•„ì›ƒ ì‹œê°„ ì¦ê°€ (server.js)
2. ë‹¤ë¥¸ ì†ŒìŠ¤ ì‚¬ìš© (nxlogis.kr)

#### ë¬¸ì œ 3: í•œê¸€ ê¹¨ì§
```
ï¿½ï¿½ï¿½ï¿½ â†’ ëŒ€ì „
```

**í•´ê²°**:
1. Dockerfileì— í•œê¸€ í°íŠ¸ í¬í•¨ë¨
2. ì¬ë°°í¬ í•„ìš”

#### ë¬¸ì œ 4: PWA ì•„ì´ì½˜ ì•ˆ ë³´ì„
**í•´ê²°**:
1. manifest.json í™•ì¸
2. íŒŒì¼ ê²½ë¡œ í™•ì¸ (`/public/icon-512.png`)
3. ë¸Œë¼ìš°ì € ìºì‹œ ì‚­ì œ

---

## ğŸ“Š ë²„ì „ ë¹„êµ

| ê¸°ëŠ¥ | v1.0 | v2.0 | v3.0 |
|------|------|------|------|
| í¬ë¡¤ë§ | ê¸°ë³¸ | API | Puppeteer âœ… |
| JavaScript ì§€ì› | âŒ | âŒ | âœ… |
| ì—´ì°¨ DB | âŒ | CSV âœ… | CSV âœ… |
| ë‹¤ì¤‘ ì†ŒìŠ¤ | âŒ | âŒ | âœ… |
| Docker | âŒ | âŒ | âœ… |
| PWA ì•„ì´ì½˜ | âŒ | âŒ | âœ… |

---

## ğŸ“± ì‚¬ìš© ë°©ë²•

### ì•± ì„¤ì¹˜

1. **ëª¨ë°”ì¼ ë¸Œë¼ìš°ì €**ì—ì„œ ì•± URL ì ‘ì†
2. **ë©”ë‰´** â†’ "í™ˆ í™”ë©´ì— ì¶”ê°€"
3. ì•„ì´ì½˜ í™•ì¸ (ì—´ì°¨ + ì‹œê³„)

### ì•ŒëŒ ìƒì„±

1. "ìƒˆ ì•ŒëŒ ë§Œë“¤ê¸°" í´ë¦­
2. **ìš´í–‰ì¼** ì„ íƒ (ê¸°ë³¸: ì˜¤ëŠ˜)
3. **ì—´ì°¨ë²ˆí˜¸** ì…ë ¥
   - "3001" ì…ë ¥
   - ë“œë¡­ë‹¤ìš´ì—ì„œ ì„ íƒ
4. **í†µê³¼ì—­** ê²€ìƒ‰
   - "ëŒ€ì „" ì…ë ¥
   - ê²€ìƒ‰ ê²°ê³¼ì—ì„œ ì„ íƒ
5. "ì €ì¥í•˜ê¸°" í´ë¦­

### ì•ŒëŒ ëŒ€ê¸°

- ì•±ì„ ë‹«ì•„ë„ ë°±ê·¸ë¼ìš´ë“œ ì‘ë™
- 1ë¶„ë§ˆë‹¤ ìë™ í™•ì¸
- ì—´ì°¨ ë„ì°© ì‹œ ì•ŒëŒ ë°œë™

---

## ğŸ”§ ê³ ê¸‰ ì„¤ì •

### í¬ë¡¤ë§ ê°„ê²© ë³€ê²½

`server.js` ìˆ˜ì •:
```javascript
// í˜„ì¬: 1ë¶„ (60000ms)
const INTERVAL = 60000;

// ë³€ê²½ ì˜ˆì‹œ: 30ì´ˆ
const INTERVAL = 30000;
```

### íƒ€ì„ì•„ì›ƒ ì‹œê°„ ì¦ê°€

`server.js` ìˆ˜ì •:
```javascript
// í˜„ì¬: 30ì´ˆ
page.setDefaultTimeout(30000);

// ë³€ê²½ ì˜ˆì‹œ: 60ì´ˆ
page.setDefaultTimeout(60000);
```

### ë©”ëª¨ë¦¬ ìµœì í™”

Dockerfile ìˆ˜ì •:
```dockerfile
# Chrome ì˜µì…˜ ì¶”ê°€
ENV CHROME_FLAGS="--disable-dev-shm-usage --disable-gpu"
```

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **í¬ë¡¤ë§ ì œí•œ**
   - 1ë¶„ ê°„ê²© ê¶Œì¥
   - ê³¼ë„í•œ ìš”ì²­ ìì œ
   - IP ì°¨ë‹¨ ê°€ëŠ¥ì„±

2. **ë©”ëª¨ë¦¬ ì‚¬ìš©**
   - PuppeteerëŠ” ë©”ëª¨ë¦¬ ë§ì´ ì‚¬ìš©
   - Free tierì—ì„œ ë¶ˆì•ˆì •í•  ìˆ˜ ìˆìŒ
   - ì¤‘ìš”í•œ ì„œë¹„ìŠ¤ëŠ” ìœ ë£Œ í”Œëœ ì‚¬ìš©

3. **ë°ì´í„° ì •í™•ì„±**
   - ì‹¤ì‹œê°„ ë°ì´í„°ê°€ ì•„ë‹ ìˆ˜ ìˆìŒ
   - ì¤‘ìš”í•œ ê²°ì •ì€ ê³µì‹ ì‚¬ì´íŠ¸ í™•ì¸
   - CSV ë°ì´í„°ëŠ” 2020ë…„ ê¸°ì¤€

4. **ë²•ì  ê³ ë ¤ì‚¬í•­**
   - í¬ë¡¤ë§ ë¡œë´‡ ë°°ì œ í‘œì¤€ ì¤€ìˆ˜
   - ê°œì¸ ì‚¬ìš© ëª©ì  ê¶Œì¥
   - ìƒì—…ì  ì‚¬ìš© ì‹œ ë¼ì´ì„ ìŠ¤ í™•ì¸

---

## ğŸ‰ ì™„ì„±!

### ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸

ë°±ì—”ë“œ:
- [ ] GitHub ì €ì¥ì†Œ ìƒì„±
- [ ] Render.com Docker ë°°í¬
- [ ] API í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- [ ] í¬ë¡¤ë§ ì‘ë™ í™•ì¸

í”„ë¡ íŠ¸ì—”ë“œ:
- [ ] Lovable.dev ì•± ìƒì„±
- [ ] PWA ì•„ì´ì½˜ ì„¤ì •
- [ ] ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- [ ] ëª¨ë°”ì¼ ì„¤ì¹˜ í™•ì¸

### ë‹¤ìŒ ë‹¨ê³„

1. âœ… ë°±ì—”ë“œ ë°°í¬
2. âœ… í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ
3. âœ… PWA ì•„ì´ì½˜ ì„¤ì •
4. âœ… ì•± í…ŒìŠ¤íŠ¸
5. ğŸŠ ì‚¬ìš© ì‹œì‘!

---

**ë¬¸ì œê°€ ë°œìƒí•˜ë©´:**
- Render.com Logs í™•ì¸
- GitHub Issues ì‘ì„±
- Lovable.dev ì»¤ë®¤ë‹ˆí‹° ë¬¸ì˜

**í”„ë¡œì íŠ¸ ì™„ì„±ì„ ì¶•í•˜í•©ë‹ˆë‹¤! ğŸ‰ğŸš‚**
